# Webpackï¼šTypeScript + Jest + Sass + ESLint

#ğŸŒˆ ğŸš€ React18 Hook + typescript4 + Jest ğŸš€

# å‰è¨€

ä»é›¶é…ç½®åŸºäº webpack5.74.0 æ­å»º React åº”ç”¨æ¨¡æ¿ï¼Œæ–¹ä¾¿å¿«é€Ÿçš„è¿›è¡Œå¼€å‘ï¼ŒReactï¼ˆReact Hook + React-router + Axios ï¼‰ESLint ç­‰é¡¹ç›®å¼€å‘è§„èŒƒç­‰ã€‚

# æŠ€æœ¯æ ˆ

æ¶‰åŠçš„æŠ€æœ¯æ ˆå‡é‡‡ç”¨å½“å‰æœ€æ–°çš„ç‰ˆæœ¬å’Œè¯­æ³•ï¼š

-   ä½¿ç”¨ Webpack5.7.1 æ„å»ºé¡¹ç›®ï¼ˆä¸ä½¿ç”¨ create-react-appã€umi ç­‰è„šæ‰‹æ¶ï¼‰ï¼›
-   ä½¿ç”¨ Babel8 é…ç½®è½¬æ¢ ES6ã€Reactã€Mobx ç­‰è¯­æ³•ï¼›
-   ä½¿ç”¨ TypeScript è¿›è¡Œä¸¥æ ¼ç±»å‹æ£€æŸ¥ï¼›
-   ä½¿ç”¨ ESLint ä»£ç è§„èŒƒæ ¡éªŒï¼ŒPrettier stylelint ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–å·¥å…·ï¼ŒEditorConfig ä»£ç é£æ ¼ç»Ÿä¸€å·¥å…·
-   React ç‰ˆæœ¬ V18.0.0ï¼Œå…¨éƒ¨é‡‡ç”¨å‡½æ•°åŒ– Hooks ç‰¹æ€§å¼€å‘é¡¹ç›®ç»„ä»¶ï¼›
-   é‡‡ç”¨ React-router6 å·¥å…· é…ç½®é¡¹ç›®è·¯ç”±ï¼›
-   é‡‡ç”¨ Mobx5 + Hooks å®ç°é¡¹ç›®æ•°æ®çŠ¶æ€ç®¡ç†ï¼›
-   å°è£… Axios åº“å®ç°ä¸åå° http è¯·æ±‚äº¤äº’ï¼›

## ç›®å½•ç»“æ„

```
â”œâ”€â”€ config                  // webpacké…ç½®
â”‚Â Â  â”œâ”€â”€ webpack.common.js   // webpacké€šç”¨é…ç½®
â”‚Â Â  â”œâ”€â”€ webpack.dev.js      // webpackå¼€å‘ç¯å¢ƒé…ç½®
â”‚Â Â  â””â”€â”€ webpack.prod.js     // webpackç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚Â Â  â””â”€â”€ paths.js            // webpackè·¯å¾„é…ç½®
â”œâ”€â”€ dist                    // æ‰“åŒ…è¾“å‡ºç›®å½•
â”œâ”€â”€ public                  // é¡¹ç›®å…¬å¼€ç›®å½•
â”œâ”€â”€ src                     // srcå¼€å‘ç›®å½•
â”‚Â Â  â”œâ”€â”€ public              // é™æ€èµ„æº
â”‚Â Â  â”œâ”€â”€ components          // å…¬å…±ç»„ä»¶
â”‚Â Â  â”œâ”€â”€ routers             // é¡¹ç›®è·¯ç”±é…ç½®
â”‚Â Â  â”œâ”€â”€ views               // å…·ä½“ä¸šåŠ¡é¡µé¢
â”‚Â Â  â”œâ”€â”€ services            // axiosæœåŠ¡ç­‰ç›¸å…³
â”‚Â Â  â”œâ”€â”€ redux               // å…¨å±€å…¬å…± mobx store
â”‚Â Â  â”œâ”€â”€ utils               // å·¥å…·åº“/é€šç”¨å‡½æ•°
â”‚Â Â  â”œâ”€â”€ typings.d.ts        // css modules ç±»å‹å£°æ˜æ–‡ä»¶
â”‚Â Â  â”œâ”€â”€ index.html          // å…¥å£htmlé¡µé¢
â”‚Â Â  â”œâ”€â”€ index.html          // å…¥å£htmlé¡µé¢
â”‚Â Â  â””â”€â”€ index.tsx           // é¡¹ç›®å…¥å£æ–‡ä»¶
â”œâ”€â”€ .babel.config.js         // babelé…ç½®,ä¾èµ–ä»€ä¹ˆæ ·çš„æ’ä»¶
â”œâ”€â”€ .browserslistrc         // æµè§ˆå™¨è¿‡æ»¤è§„åˆ™é…ç½®,babelä¾èµ–è¿™ä¸ªæ–‡ä»¶ï¼ŒåŒæ ·cssä¹Ÿä¾èµ–
â”œâ”€â”€ .editorconfig            // é¡¹ç›®æ ¼å¼é…ç½®
â”œâ”€â”€ .eslintrc.json          // ESLinté…ç½®
â”œâ”€â”€ .eslintignore           // ESLinté…ç½®å±è”½ä¸éœ€è¦æ£€æµ‹çš„æ–‡ä»¶æˆ–ç›®å½•
â”œâ”€â”€ .prettierrc.js          // Prettier ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–é…ç½®
â”œâ”€â”€ .prettierignore         // Prettier ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–é…ç½®å±è”½ä¸å¿…è¦çš„æ–‡ä»¶
â”œâ”€â”€ .editorconfig            // EditorConfig ä»£ç é£æ ¼ç»Ÿä¸€é…ç½®
â”œâ”€â”€ .jest.config.js          // jestä»£ç æµ‹è¯•é…ç½®
â”œâ”€â”€ .stylelintrc.js         // stylelintæ˜¯CSS è§„èŒƒæ ¡éªŒå·¥å…·é…ç½®
â”œâ”€â”€ .gitignore              // git å¿½ç•¥é…ç½®
â”œâ”€â”€ .postcssrc.js           // postcssé…ç½®,ä¾èµ–ä»€ä¹ˆæ ·çš„æ’ä»¶
â”œâ”€â”€ tsconfig.json            // typescripté…ç½®
â”œâ”€â”€ package.json            // ä¾èµ–åŒ…é…ç½®
â””â”€â”€ README.md               // é¡¹ç›®è¯´æ˜


```

### æœ¬åœ° node æœåŠ¡å™¨

### é…åˆ¶ json-serve

ä¼˜ç‚¹ï¼š
1ã€é…åˆ¶ç®€å•,json-server å¯ä»¥ç¬é—´èµ·åŠ¨ REST API Server 2.å¢åˆ æ”¹æŸ¥çœŸå®æ¨¡æ‹Ÿ

ç¼ºç‚¹ï¼šä¸æ¥å£ç®¡ç†å·¥å…·ç›¸æ¯”ï¼Œæ— æ³•éšåç«¯ API çš„ä¿®æ”¹è€Œè‡ªåŠ¨ä¿®æ”¹

```

yarn add json-server

```

## ä½¿ç”¨ dotenv åŠ è½½.env---å…¨å±€ç¯å¢ƒå˜é‡

dotenv æ˜¯ä¸€ä¸ªé›¶ä¾èµ–æ¨¡å—ï¼Œå®ƒå°†ç¯å¢ƒå˜é‡ä» .env æ–‡ä»¶åŠ è½½åˆ° process.env ä¸­ã€‚dotenv æä¾›è®¸å¤šçš„æ–¹æ³•ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ dotenv.config()ã€‚
æœ€å¸¸ç”¨çš„æ˜¯é…åˆ¶.env æ–‡ä»¶ï¼Œå¯ä»¥é…åˆ¶ä¸Šçº¿æ‰€éœ€è¦çš„ API æ¥å£çš„ URL

ä¸€ã€ .env æ–‡ä»¶è¯´æ˜

.env --- å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œåœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­è¢«è½½å…¥ï¼Œå½“ä½ æŒ‡å®šäº†ç¯å¢ƒï¼Œå®ƒä¹Ÿä¼šåˆå¹¶,å¹¶ä¸”ä¼˜å…ˆçº§å¤§äº.envï¼Œæ²¡æœ‰æŒ‡å®šç¯å¢ƒæ—¶å…ˆæ‰¾å®ƒ

.env.development --- æŒ‡å®šå¼€å‘ç¯å¢ƒçš„é…ç½®æ–‡ä»¶

.env.production --- æŒ‡å®šç”Ÿäº§ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œå½“ build è¿è¡Œä¼šè§¦å‘æ­¤æ–‡ä»¶

å…ˆåœ¨.env æ–‡ä»¶ä¸­å£°æ˜ç¯å¢ƒå˜é‡

å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œæ— è®ºä»€ä¹ˆç¯å¢ƒéƒ½ä¼šåŠ è½½åˆå¹¶

```
REACT_APP_API_URL=online.com

```

åœ¨ webpack.common.jsï¼Œå†…å®¹å¦‚ä¸‹

```
const Dotenv = require('dotenv-webpack');
module.exports = {
    plugins: [
        new Dotenv()
    ]
}
```

ç„¶åæ— è®ºä½ æƒ³åœ¨å“ªé‡Œä½¿ç”¨å˜é‡.env å†™

```
process.env.REACT_APP_YOURVARIABLE
```

æ— éœ€å¯¼å…¥ dotenv. å®ƒå·²ç»åœ¨ webpack.common.js

### dotenv åŠ è½½ä¼˜å…ˆçº§

.env å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œæ— è®ºä»€ä¹ˆç¯å¢ƒéƒ½ä¼šåŠ è½½åˆå¹¶
.env.development å¼€å‘ç¯å¢ƒçš„å…¨å±€é…ç½®æ–‡ä»¶
dotenv.config() æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ª option å¯¹è±¡ï¼Œå…¶ä¸­ option.path ä»£è¡¨æˆ‘ä»¬æœŸæœ›åŠ è½½çš„.env\*æ–‡ä»¶è·¯å¾„ã€‚
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªè¦ä¸€ä¸ªç¯å¢ƒå˜é‡å·²ç»è¢«è®¾ç½®è¿‡ï¼Œdotenv å°±ä¸ä¼šä¿®æ”¹å®ƒ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œdotenv å§‹ç»ˆä»¥å…ˆåŠ è½½åˆ°çš„å˜é‡å£°æ˜ä¸ºæ›´é«˜ä¼˜å…ˆçº§

æˆ‘ä»¬æœŸæœ›çš„æ•ˆæœæ˜¯ï¼Œ.env.local æ–‡ä»¶ä¸­å®šä¹‰çš„ç¯å¢ƒå˜é‡è·å¾—æœ€é«˜ä¼˜å…ˆçº§ï¼Œ.env.development å…¶æ¬¡ï¼Œ.env ä¸­çš„é€šç”¨é…ç½®ä¼˜å…ˆçº§æœ€ä½ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ config/env.js ä¸­è¿›è¡Œå¦‚ä¸‹çš„å¤„ç†ï¼š

```
// config/env.js

const path = require("path");
const fs = require("fs");
const dotEnv = require("dotenv");

// å…ˆæ„é€ å‡º.env*æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
const appDirectory = fs.realpathSync(process.cwd());
const resolveApp = (relativePath) => path.resolve(appDirectory, relativePath);
const pathsDotenv = resolveApp(".env");

// æŒ‰ä¼˜å…ˆçº§ç”±é«˜åˆ°ä½çš„é¡ºåºåŠ è½½.envæ–‡ä»¶
dotEnv.config({ path: `${pathsDotenv}.local` })  // åŠ è½½.env.local
dotEnv.config({ path: `${pathsDotenv}.development` })  // åŠ è½½.env.development
dotEnv.config({ path: `${pathsDotenv}` })  // åŠ è½½.env

// æ‰“å°ä¸€ä¸‹æ­¤æ—¶çš„process.env
console.log(process.env.NAME);
console.log(process.env.AGE); // 20
console.log(process.env.COUNTRY); // China
console.log(process.env.LOCAL_ENV); // local
```
