# Webpackï¼šTypeScript + Jest + Sass + ESLint

#ğŸŒˆ ğŸš€ React18 Hook + typescript4 + Jest ğŸš€

# å‰è¨€

ä»é›¶é…ç½®åŸºäº webpack5.58.1 æ­å»º React åº”ç”¨æ¨¡æ¿ï¼Œæ–¹ä¾¿å¿«é€Ÿçš„è¿›è¡Œå¼€å‘ï¼ŒReactï¼ˆReact Hook + typescript+Antd ï¼‰ESLint ç­‰é¡¹ç›®å¼€å‘è§„èŒƒç­‰ã€‚

# æŠ€æœ¯æ ˆ

æ¶‰åŠçš„æŠ€æœ¯æ ˆå‡é‡‡ç”¨å½“å‰æœ€æ–°çš„ç‰ˆæœ¬å’Œè¯­æ³•ï¼š

-   ä½¿ç”¨ webpack5.58.1 æ„å»ºé¡¹ç›®ï¼ˆä¸ä½¿ç”¨ create-react-appã€umi ç­‰è„šæ‰‹æ¶ï¼‰ï¼›
-   ä½¿ç”¨ Babel8 é…ç½®è½¬æ¢ ES6ã€Reactã€Mobx ç­‰è¯­æ³•ï¼›
-   ä½¿ç”¨ TypeScript è¿›è¡Œä¸¥æ ¼ç±»å‹æ£€æŸ¥ï¼›
-   ä½¿ç”¨ ESLint ä»£ç è§„èŒƒæ ¡éªŒï¼ŒPrettier stylelint ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–å·¥å…·ï¼ŒEditorConfig ä»£ç é£æ ¼ç»Ÿä¸€å·¥å…·
-   React ç‰ˆæœ¬ V18.0.0ï¼Œå…¨éƒ¨é‡‡ç”¨å‡½æ•°åŒ– Hooks ç‰¹æ€§å¼€å‘é¡¹ç›®ç»„ä»¶ï¼›
-   é‡‡ç”¨ React-router6 å·¥å…· é…ç½®é¡¹ç›®è·¯ç”±ï¼›
-   é‡‡ç”¨ redux + Hooks å®ç°é¡¹ç›®æ•°æ®çŠ¶æ€ç®¡ç†ï¼›

## ç›®å½•ç»“æ„

```
â”œâ”€â”€ config                     // webpacké…ç½®
â”‚Â Â  â”œâ”€â”€ webpack.common.ts      // webpacké€šç”¨é…ç½®
â”‚Â Â  â”œâ”€â”€ webpack.dev.ts         // webpackå¼€å‘ç¯å¢ƒé…ç½®
â”‚Â Â  â””â”€â”€ webpack.prod.ts        // webpackç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ dist                       // æ‰“åŒ…è¾“å‡ºç›®å½•
â”œâ”€â”€ public                     // é¡¹ç›®å…¬å¼€ç›®å½•
â”œâ”€â”€ util                       // é€šè¿‡ AppleScript é‡ç”¨ç°æœ‰çš„ Chrome é€‰é¡¹å¡
â”‚   â”œâ”€â”€ openbrowser.js         // ä½¿ç”¨ç»™å®šçš„ URL æ‰“å¼€æµè§ˆå™¨çš„æ–‡ä»¶
â”‚   â”œâ”€â”€ openChrome.applescript // Macä¸‹çš„é…åˆ¶æ–‡ä»¶
â”œâ”€â”€ src                        // srcå¼€å‘ç›®å½•
â”‚Â Â  â”œâ”€â”€ public                 // é™æ€èµ„æº
â”‚Â Â  â”œâ”€â”€ components             // å…¬å…±ç»„ä»¶
â”‚Â Â  â”œâ”€â”€ routers                // é¡¹ç›®è·¯ç”±é…ç½®
â”‚Â Â  â”œâ”€â”€ pages                  // å…·ä½“ä¸šåŠ¡é¡µé¢
â”‚   â”œâ”€â”€ css                    // æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ redux                  // å…¨å±€å…¬å…± mobx store
â”‚Â Â  â”œâ”€â”€ utils                  // å·¥å…·åº“/é€šç”¨å‡½æ•°
â”‚Â Â  â”œâ”€â”€ typings.d.ts           // css modules ç±»å‹å£°æ˜æ–‡ä»¶
â”‚   â”œâ”€â”€ App.less               // Antdæ ·å¼
â”‚   â”œâ”€â”€ App.tsx                // å…¥å£é¡µé¢
â”‚   â”œâ”€â”€ typings.d.ts           // buildæ—¶å£°æ˜æ–‡ä»¶typings.d.ts
â”‚Â Â  â””â”€â”€ index.tsx              // é¡¹ç›®å…¥å£æ–‡ä»¶
â”œâ”€â”€ .babelrc                   // babelé…ç½®,ä¾èµ–ä»€ä¹ˆæ ·çš„æ’ä»¶
â”œâ”€â”€ .browserslistrc            // æµè§ˆå™¨è¿‡æ»¤è§„åˆ™é…ç½®,babelä¾èµ–è¿™ä¸ªæ–‡ä»¶ï¼ŒåŒæ ·cssä¹Ÿä¾èµ–
â”œâ”€â”€ .eslintrc.js               // ESLinté…ç½®
â”œâ”€â”€ .eslintignore              // ESLinté…ç½®å±è”½ä¸éœ€è¦æ£€æµ‹çš„æ–‡ä»¶æˆ–ç›®å½•
â”œâ”€â”€ .prettierrc.js             // Prettier ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–é…ç½®
â”œâ”€â”€ .prettierignore            // Prettier ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–é…ç½®å±è”½ä¸å¿…è¦çš„æ–‡ä»¶
â”œâ”€â”€ .editorconfig              // EditorConfig ä»£ç é£æ ¼ç»Ÿä¸€é…ç½®
â”œâ”€â”€ .jest.config.js            // jestä»£ç æµ‹è¯•é…ç½®
â”œâ”€â”€ .stylelintrc.js            // stylelintæ˜¯CSS è§„èŒƒæ ¡éªŒå·¥å…·é…ç½®
â”œâ”€â”€ .gitignore                 // git å¿½ç•¥é…ç½®
â”œâ”€â”€ .postcssrc.js              // postcssé…ç½®,ä¾èµ–ä»€ä¹ˆæ ·çš„æ’ä»¶,PostCSSæ˜¯ä¸€ä¸ªç”¨ JavaScript å·¥å…·å’Œæ’ä»¶è½¬æ¢ CSS ä»£ç çš„å·¥å…·
â”œâ”€â”€ tsconfig.json              // typescripté…ç½®
â”œâ”€â”€ package.json               // ä¾èµ–åŒ…é…ç½®
â””â”€â”€ README.md                  // é¡¹ç›®è¯´æ˜

```

### æœ¬åœ° node æœåŠ¡å™¨

### é…åˆ¶ json-serve

ä¼˜ç‚¹ï¼š
1ã€é…åˆ¶ç®€å•,json-server å¯ä»¥ç¬é—´èµ·åŠ¨ REST API Server 2.å¢åˆ æ”¹æŸ¥çœŸå®æ¨¡æ‹Ÿ

ç¼ºç‚¹ï¼šä¸æ¥å£ç®¡ç†å·¥å…·ç›¸æ¯”ï¼Œæ— æ³•éšåç«¯ API çš„ä¿®æ”¹è€Œè‡ªåŠ¨ä¿®æ”¹

```

yarn add json-server

```

## ä½¿ç”¨ dotenv åŠ è½½.env---å…¨å±€ç¯å¢ƒå˜é‡

```

yarn add -D dotenv-webpack

```

dotenv æ˜¯ä¸€ä¸ªé›¶ä¾èµ–æ¨¡å—ï¼Œå®ƒå°†ç¯å¢ƒå˜é‡ä» .env æ–‡ä»¶åŠ è½½åˆ° process.env ä¸­ã€‚dotenv æä¾›è®¸å¤šçš„æ–¹æ³•ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ dotenv.config()ã€‚
æœ€å¸¸ç”¨çš„æ˜¯é…åˆ¶.env æ–‡ä»¶ï¼Œå¯ä»¥é…åˆ¶ä¸Šçº¿æ‰€éœ€è¦çš„ API æ¥å£çš„ URL,å‡¡æ˜¯åœ¨ .env è®¾ç½®çš„å…¨å±€å˜é‡ï¼Œä¸€å¾‹éƒ½æ˜¯ä½¿ç”¨ process.env.XXX å°‡å…¶è¯»å–ï¼Œé€™é‚Šå”¯ä¸€è¦æ³¨æ„çš„æ˜¯ .env è®¾ç½®çš„å…¨å±€å˜é‡éƒ½æ˜¯å±äºå­—ç¬¦ä¸²ï¼Œåœ¨æŸäº›æƒ…æ³ä¸‹æˆ‘ä»¬å¾—è‡ªå·±å¤„ç†è½¬å‹çš„é—®é¡Œã€‚

ä¸€ã€ .env æ–‡ä»¶è¯´æ˜

.env --- å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œåœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­è¢«è½½å…¥

.env.development --- æŒ‡å®šå¼€å‘ç¯å¢ƒçš„é…ç½®æ–‡ä»¶

.env.production --- æŒ‡å®šç”Ÿäº§ç¯å¢ƒçš„é…ç½®æ–‡ä»¶ï¼Œå½“ build è¿è¡Œä¼šè§¦å‘æ­¤æ–‡ä»¶

äºŒã€åœ¨æ ¹ç›®å½•ä¸‹å»ºç«‹ä¸¤ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåªå»ºç«‹.env å’Œ.env.development ä¸¤ä¸ªæ–‡ä»¶

```
 webpack-demo/
 â”‚
+â””â”€â”€â”€ .env
+â””â”€â”€â”€ env.development

```

å…ˆåœ¨.env æ–‡ä»¶ä¸­å£°æ˜ç¯å¢ƒå˜é‡ï¼Œç„¶åæ— è®ºä½ æƒ³åœ¨å“ªé‡Œä½¿ç”¨å˜é‡ .env éƒ½å¯ç”¨ä¸‹é¢çš„æ–¹å¼

```
process.env.REACT_APP_YOURVARIABLE
```

å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œæ— è®ºä»€ä¹ˆç¯å¢ƒéƒ½ä¼šåŠ è½½åˆå¹¶,æˆ‘ä»¬åœ¨è¿™é‡Œè®¾ç½®ä¸Šçº¿è¿è¡Œæ—¶çš„ URl åœ°å€

```
REACT_APP_API_URL=online.com

```

åœ¨.env.development æ–‡ä»¶ä¸­è®¾ç½®å¼€å‘æ—¶çš„ URl åœ°å€ï¼Œå‚è€ƒå¦‚ä¸‹

```
REACT_APP_API_URL=http://localhost:5000

```

ä¸‰.å°†å…¨å±€å˜é‡æ–‡ä»¶åœ¨ github ä¸­éšè—

ç›®å‰ï¼Œæˆ‘ä»¬åªæ˜¯å°†å…¨å±€å˜é‡çš„ API è¯·æ±‚åœ°å€å†™åˆ°.env æ–‡ä»¶å†…ï¼Œä¸ºäº†è¾¾åˆ°éšè—ç›®çš„ï¼Œå¯å°†å…¶æ–°å¢è‡³.gitignore å†…ï¼Œè¿™æ ·å¯ä»¥é¿å… GitHub å†…å­˜åœ¨ä»»ä½•å‹æ€çš„å…¨å±€å˜é‡

```
.env
.env.development

```

å››ã€dotenv-webpack å¯ä¼ å‚é€‰é¡¹
å¯å‚è€ƒ dotenv-webpack Options å¯ä¼ å‚åˆ—è¡¨ï¼Œä»¥ä¸‹ä¸ºå¸¸ç”¨å‚æ•°é…ç½®ï¼š
path: String
é…ç½®å…¨å±€å˜ç†ä½ç½®ï¼Œé»˜è®¤ä¸º./.env

systemvars:Boolean
å……è®¸åŠ è½½æ‰€æœ‰ç³»ç»Ÿå˜é‡

åœ¨ webpack.common.jsï¼Œå†…å®¹å¦‚ä¸‹

```
const Dotenv = require("dotenv-webpack");

module.exports = {
  plugins: [
    new Dotenv({
      path:
        process.env.NODE_ENV === "development"
          ? "./.env.development"
          : "./.env.production",
      systemvars: true, // å…è¨±è®€å– process.env ä¸‹çš„ä»»æ„ç³»çµ±è®Šé‡
    }),
  ],
};
```

### ä¸ºé¡¹ç›®æ·»åŠ  UI åº“-Antd

é¦–å…ˆå®‰è£… Antd ä¾èµ–

```
yarn add antd
```
